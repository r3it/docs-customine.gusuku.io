---
title: "期を計算する"
date: 2018-01-22T16:07:50+09:00
weight: 1470
---

## 概要

指定の日付の期数を計算します。結果は他のアクションから参照できます。

## 使い方

計算結果を別のフィールドに入れたい場合、「セット先フィールド（省略可）」パラメーターにそのフィールドを選択します。

計算結果をすぐフィールドに入れるのではなく、他のアクションで使いたい場合は数式を利用します。

「期を計算する」をセットしたアクションを実行すると、アクションの結果としてその日付が内部に保存されます。

保存された期は、数式を使用して、「=$1」などで取得できます。

例）計算結果の期を、他のアクション（「[レコードを追加する](../../record/insert_record/)」）で使用する例

1. 「期を計算する」を設置します。アクション番号が１番だったとします。
2. 「[レコードを追加する](../../record/insert_record/)」の「マッピング」で、セットしたいフィールドに対して「=$1」と入れます。
    （「期を計算する」のアクション番号が２番だったら、「=$2」とします）

### 設定するパラメーター

「日付」「年度開始月」「第１期の年」「セット先フィールド（省略可）」を設定します。

#### 日付

年度を計算する日付を入力します。

日付フィールドや日時フィールドの値を参照したい場合

```
=日付_2
```

のように、「=」をつけてフィールドコードで参照してください。

現在の日付の日付を基準としたい場合は

```
=today()
```

と入力します。

#### 年度開始月

年度開始月を選択します。

#### 第１期の年

第１期の年を西暦の数字で入力します。

例えば年度開始月が10月で、第１期の年が2000の場合、

- 日付が2000年10月 ⇒ 1
- 日付が2001年9月 ⇒ 1
- 日付が2001年10月 ⇒ 2

という結果になります。

#### セット先フィールド（省略可）

計算結果を他のフィールドにセットする場合に指定します。直接フィールドにはセットせず、計算結果を別のアクションで使用したい場合は、省略できます。

## 制限事項

結果が第１期開始よりも前の日付を指定すると、結果として０やマイナスの値になる場合があります。この場合もエラーにはなりません。
